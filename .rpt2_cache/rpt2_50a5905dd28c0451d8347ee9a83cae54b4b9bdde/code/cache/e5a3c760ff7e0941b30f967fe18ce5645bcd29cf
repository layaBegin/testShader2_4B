{
  "code": "export default class CameraMoveScript extends Laya.Script3D {\r\n    constructor() {\r\n        super();\r\n        this._tempVector3 = new Laya.Vector3();\r\n        this.yawPitchRoll = new Laya.Vector3();\r\n        this.resultRotation = new Laya.Quaternion();\r\n        this.tempRotationZ = new Laya.Quaternion();\r\n        this.tempRotationX = new Laya.Quaternion();\r\n        this.tempRotationY = new Laya.Quaternion();\r\n        this.rotaionSpeed = 0.00006;\r\n    }\r\n    _updateRotation() {\r\n        if (Math.abs(this.yawPitchRoll.y) < 1.50) {\r\n            Laya.Quaternion.createFromYawPitchRoll(this.yawPitchRoll.x, this.yawPitchRoll.y, this.yawPitchRoll.z, this.tempRotationZ);\r\n            this.tempRotationZ.cloneTo(this.camera.transform.localRotation);\r\n            this.camera.transform.localRotation = this.camera.transform.localRotation;\r\n        }\r\n    }\r\n    onAwake() {\r\n        Laya.stage.on(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);\r\n        Laya.stage.on(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);\r\n        this.camera = this.owner;\r\n    }\r\n    onUpdate() {\r\n        var elapsedTime = Laya.timer.delta;\r\n        if (!isNaN(this.lastMouseX) && !isNaN(this.lastMouseY) && this.isMouseDown) {\r\n            var scene = this.owner.scene;\r\n            Laya.KeyBoardManager.hasKeyDown(87) && this.moveForward(-0.01 * elapsedTime);\r\n            Laya.KeyBoardManager.hasKeyDown(83) && this.moveForward(0.01 * elapsedTime);\r\n            Laya.KeyBoardManager.hasKeyDown(65) && this.moveRight(-0.01 * elapsedTime);\r\n            Laya.KeyBoardManager.hasKeyDown(68) && this.moveRight(0.01 * elapsedTime);\r\n            Laya.KeyBoardManager.hasKeyDown(81) && this.moveVertical(0.01 * elapsedTime);\r\n            Laya.KeyBoardManager.hasKeyDown(69) && this.moveVertical(-0.01 * elapsedTime);\r\n            var offsetX = Laya.stage.mouseX - this.lastMouseX;\r\n            var offsetY = Laya.stage.mouseY - this.lastMouseY;\r\n            var yprElem = this.yawPitchRoll;\r\n            yprElem.x -= offsetX * this.rotaionSpeed * elapsedTime;\r\n            yprElem.y -= offsetY * this.rotaionSpeed * elapsedTime;\r\n            this._updateRotation();\r\n        }\r\n        this.lastMouseX = Laya.stage.mouseX;\r\n        this.lastMouseY = Laya.stage.mouseY;\r\n    }\r\n    onDestroy() {\r\n        Laya.stage.off(Laya.Event.RIGHT_MOUSE_DOWN, this, this.mouseDown);\r\n        Laya.stage.off(Laya.Event.RIGHT_MOUSE_UP, this, this.mouseUp);\r\n    }\r\n    mouseDown(e) {\r\n        this.camera.transform.localRotation.getYawPitchRoll(this.yawPitchRoll);\r\n        this.lastMouseX = Laya.stage.mouseX;\r\n        this.lastMouseY = Laya.stage.mouseY;\r\n        this.isMouseDown = true;\r\n    }\r\n    mouseUp(e) {\r\n        this.isMouseDown = false;\r\n    }\r\n    mouseOut(e) {\r\n        this.isMouseDown = false;\r\n    }\r\n    moveForward(distance) {\r\n        this._tempVector3.x = this._tempVector3.y = 0;\r\n        this._tempVector3.z = distance;\r\n        this.camera.transform.translate(this._tempVector3);\r\n    }\r\n    moveRight(distance) {\r\n        this._tempVector3.y = this._tempVector3.z = 0;\r\n        this._tempVector3.x = distance;\r\n        this.camera.transform.translate(this._tempVector3);\r\n    }\r\n    moveVertical(distance) {\r\n        this._tempVector3.x = this._tempVector3.z = 0;\r\n        this._tempVector3.y = distance;\r\n        this.camera.transform.translate(this._tempVector3, false);\r\n    }\r\n}\r\n",
  "references": []
}
