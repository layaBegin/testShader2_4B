{
  "code": "import CameraMoveScript from \"./common/CameraMoveScript\";\r\nimport CustomTerrainMaterial from \"./customMaterials/CustomTerrainMaterial\";\r\nexport default class Shader_Terrain {\r\n    constructor() {\r\n        Laya3D.init(0, 0);\r\n        Laya.stage.scaleMode = Laya.Stage.SCALE_FULL;\r\n        Laya.stage.screenMode = Laya.Stage.SCREEN_NONE;\r\n        Laya.Stat.show();\r\n        this.initShader();\r\n        var scene = Laya.stage.addChild(new Laya.Scene3D);\r\n        var camera = scene.addChild(new Laya.Camera(0, 0.1, 1000));\r\n        camera.transform.rotate(new Laya.Vector3(-18, 180, 0), false, false);\r\n        camera.transform.translate(new Laya.Vector3(-28, 20, -18), false);\r\n        camera.addComponent(CameraMoveScript);\r\n        Laya.Mesh.load(\"res/threeDimen/skinModel/Terrain/terrain_New-Part-01.lm\", Laya.Handler.create(this, function (mesh) {\r\n            var terrain = scene.addChild(new Laya.MeshSprite3D(mesh));\r\n            var customMaterial = new CustomTerrainMaterial();\r\n            Laya.Texture2D.load(\"res/threeDimen/skinModel/Terrain/splatAlphaTexture.png\", Laya.Handler.create(null, function (tex) {\r\n                customMaterial.splatAlphaTexture = tex;\r\n            }));\r\n            Laya.Texture2D.load(\"res/threeDimen/skinModel/Terrain/ground_01.jpg\", Laya.Handler.create(null, function (tex) {\r\n                customMaterial.diffuseTexture1 = tex;\r\n            }));\r\n            Laya.Texture2D.load(\"res/threeDimen/skinModel/Terrain/ground_02.jpg\", Laya.Handler.create(null, function (tex) {\r\n                customMaterial.diffuseTexture2 = tex;\r\n            }));\r\n            Laya.Texture2D.load(\"res/threeDimen/skinModel/Terrain/ground_03.jpg\", Laya.Handler.create(null, function (tex) {\r\n                customMaterial.diffuseTexture3 = tex;\r\n            }));\r\n            Laya.Texture2D.load(\"res/threeDimen/skinModel/Terrain/ground_04.jpg\", Laya.Handler.create(null, function (tex) {\r\n                customMaterial.diffuseTexture4 = tex;\r\n            }));\r\n            customMaterial.setDiffuseScale1(new Laya.Vector2(27.92727, 27.92727));\r\n            customMaterial.setDiffuseScale2(new Laya.Vector2(13.96364, 13.96364));\r\n            customMaterial.setDiffuseScale3(new Laya.Vector2(18.61818, 18.61818));\r\n            customMaterial.setDiffuseScale4(new Laya.Vector2(13.96364, 13.96364));\r\n            terrain.meshRenderer.sharedMaterial = customMaterial;\r\n        }));\r\n    }\r\n    initShader() {\r\n        CustomTerrainMaterial.__init__();\r\n        var attributeMap = {\r\n            'a_Position': Laya.VertexMesh.MESH_POSITION0,\r\n            'a_Normal': Laya.VertexMesh.MESH_NORMAL0,\r\n            'a_Texcoord0': Laya.VertexMesh.MESH_TEXTURECOORDINATE0\r\n        };\r\n        var uniformMap = {\r\n            'u_MvpMatrix': Laya.Shader3D.PERIOD_SPRITE,\r\n            'u_WorldMat': Laya.Shader3D.PERIOD_SPRITE,\r\n            'u_CameraPos': Laya.Shader3D.PERIOD_CAMERA,\r\n            'u_SplatAlphaTexture': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseTexture1': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseTexture2': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseTexture3': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseTexture4': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseTexture5': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseScale1': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseScale2': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseScale3': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseScale4': Laya.Shader3D.PERIOD_MATERIAL,\r\n            'u_DiffuseScale5': Laya.Shader3D.PERIOD_MATERIAL\r\n        };\r\n        var vs = `\n        #include \"Lighting.glsl\";\n        attribute vec4 a_Position;\n        attribute vec2 a_Texcoord0;\n        attribute vec3 a_Normal;\n        uniform mat4 u_MvpMatrix;\n        varying vec2 v_Texcoord0;\n        void main()\n        {\n          gl_Position = u_MvpMatrix * a_Position;\n          v_Texcoord0 = a_Texcoord0;\n          gl_Position=remapGLPositionZ(gl_Position);\n       }`;\r\n        var ps = `\n        #ifdef FSHIGHPRECISION\n        precision highp float;\n        #else\n        precision mediump float;\n        #endif\n        uniform sampler2D u_SplatAlphaTexture;\n        uniform sampler2D u_DiffuseTexture1;\n        uniform sampler2D u_DiffuseTexture2;\n        uniform sampler2D u_DiffuseTexture3;\n        uniform sampler2D u_DiffuseTexture4;\n        uniform sampler2D u_DiffuseTexture5;\n        uniform vec2 u_DiffuseScale1;\n        uniform vec2 u_DiffuseScale2;\n        uniform vec2 u_DiffuseScale3;\n        uniform vec2 u_DiffuseScale4;\n        uniform vec2 u_DiffuseScale5;\n        varying vec2 v_Texcoord0;\n        void main()\n        {\n        #ifdef CUSTOM_DETAIL_NUM1\n        vec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n        vec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScale1);\n        gl_FragColor.xyz = color1.xyz * splatAlpha.r;\n        #elif defined(CUSTOM_DETAIL_NUM2)\n        vec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n        vec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScale1);\n        vec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScale2);\n        gl_FragColor.xyz = color1.xyz * splatAlpha.r + color2.xyz * (1.0 - splatAlpha.r);\n        #elif defined(USTOM_DETAIL_NUM3)\n        vec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n        vec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScale1);\n        vec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScale2);\n        vec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScale3);\n        gl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * (1.0 - splatAlpha.r - splatAlpha.g);\n        #elif defined(CUSTOM_DETAIL_NUM4)\n        vec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n        vec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScale1);\n        vec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScale2);\n        vec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScale3);\n        vec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScale4);\n        gl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b);\n        #elif defined(CUSTOM_DETAIL_NUM5)\n        vec4 splatAlpha = texture2D(u_SplatAlphaTexture, v_Texcoord0);\n        vec4 color1 = texture2D(u_DiffuseTexture1, v_Texcoord0 * u_DiffuseScale1);\n        vec4 color2 = texture2D(u_DiffuseTexture2, v_Texcoord0 * u_DiffuseScale2);\n        vec4 color3 = texture2D(u_DiffuseTexture3, v_Texcoord0 * u_DiffuseScale3);\n        vec4 color4 = texture2D(u_DiffuseTexture4, v_Texcoord0 * u_DiffuseScale4);\n        vec4 color5 = texture2D(u_DiffuseTexture5, v_Texcoord0 * u_DiffuseScale5);\n        gl_FragColor.xyz = color1.xyz * splatAlpha.r  + color2.xyz * splatAlpha.g + color3.xyz * splatAlpha.b + color4.xyz * splatAlpha.a + color5.xyz * (1.0 - splatAlpha.r - splatAlpha.g - splatAlpha.b - splatAlpha.a);\n        #else\n        #endif\n        }`;\r\n        var customTerrianShader = Laya.Shader3D.add(\"CustomTerrainShader\");\r\n        var subShader = new Laya.SubShader(attributeMap, uniformMap);\r\n        customTerrianShader.addSubShader(subShader);\r\n        subShader.addShaderPass(vs, ps);\r\n    }\r\n}\r\nnew Shader_Terrain;\r\n",
  "references": [
    "D:/layaTestProject/testShader2_4B/src/script/LayaAir3D_Shader/common/CameraMoveScript.ts",
    "D:/layaTestProject/testShader2_4B/src/script/LayaAir3D_Shader/customMaterials/CustomTerrainMaterial.ts"
  ]
}
